<!doctype html>
<html lang="zh-Hans">

<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width initial-scale=1'>
  <title>错排数</title>
  <meta name="keywords" content="Wankupi,王鲲鹏,blog,博客,Blog,wankupi,oier">
  <meta name="description" content="这里是王鲲鹏的博客，有自己写的一些文章，日志等。让我们奋勇拼搏，不负青春韶华!">
  <meta name="author" content="Wankupi">
  <link rel="icon" type="image/png" sizes="640x640" href="/static/images/icon.png">
  <link rel="stylesheet" type="text/css" href="/static/css/article.css">
  <script src="/static/js/loads.js" async></script>
</head>

<body>
  <div class="card art-container">
    <h1>错排数</h1>
    <p>$n$ 的所有排列中满足 $\forall i (p_i \not= i)$ 的排列数量。</p>
    <h4>递推</h4>
    <div>$$ D_n=(n-1)(D_{n-1}+D_{n-2}) $$
    </div>
    <p>边界 $D_0=1$，$D_1=0$，$D_2=1$。</p>
    <p>先考虑向 $n-1$ 的排列中加入 $n$ 到位置 $k$，一共有 $n-1$ 种放法。考虑第 $k$ 个元素，可以放在 $n$ 位置，贡献是$D_{n-2}$， 因为已经确定两个元素；放在非 $n$ 位置，这就相当于认为 $k$ 本应放在 $n$ 位置，这时的错位排数，贡献是 $D_{n-1}$。</p>
    <p>上式变形得，$D_n-n D_{n-1}=-(D_{n-1}-(n-1)D_{n-2})$，边界情况 $D_1-1\cdot D_0=-1$。所以 $D_n-nD_{n-1}=(-1)^n$，$D_n=nD_{n-1}+(-1)^n$。</p>
    <p>&nbsp;</p>
    <h4>通项公式</h4>
    <div>$$ D_n=n!\sum_{i=0}^{n}\frac{(-1)^i}{i!} $$
    </div>
    <h5>二项式反演</h5>
    <p>对于 $n$ 的所有排列，可以划分为恰有 $i\in\{0,1,2,\cdots,n\}$ 个元素是乱序，剩下$n-i$ 个元素不动的排列数的和。</p>
    <div>$$ n!=\sum_{i=0}^{n}\binom{n}{i}D_i $$
    </div>
    <p>反演得</p>
    <div>$$ D_n=\sum_{i=0}^{n}(-1)^{n-i}\binom{n}{i}i! =\sum_{i=0}^{n}(-1)^{n-i}\frac{n!}{(n-i)!} =n!\sum_{i=0}^{n}\frac{(-1)^i}{i~} $$
    </div>
    <h5>生成函数</h5>
    <div>$$ G(x)=D_0+D_1\frac{x}{1!}+D_2\frac{x^2}{2!}+D_3\frac{x^3}{3!}+\cdots $$
    </div>
    <p>由递推关系 $D_n=nD_{n-1}+(-1)^n$，</p>
    <div>$$ \begin{align} G(x)&amp;=D_0+(D_0+(-1)^1)\frac{x}{1!}+(D_1+(-1)^n)\frac{x^2}{2!}+(D_2+(-1)^3)\frac{x^3}{3!}+\cdots \\ &amp;=x(D_0+D_1\frac{x}{1!}+D_2\frac{x^2}{2!}+\cdots)+(1-\frac{x}{1!}+\frac{x^2}{2!}-\frac{x^3}{3!}+\cdots) \\ &amp;=xG(x)+e^{-x}\\
      \end{align} $$
    </div>
    <p>所以，</p>
    <div>$$ G(x)=\frac{e^{-x}}{1-x}=(1-\frac{x}{1!}+\frac{x^2}{2!}-\frac{x^3}{3!}+\cdots)(1+x+x^2+x^3+\cdots) $$
    </div>
    <p>对应系数相等，</p>
    <div>$$ \frac{D_n}{n!}=\sum_{i=0}^{n}\frac{(-1)^{i}}{i!} $$
    </div>
  </div>
  <div id="Comment" class="card"></div>
</body>

</html>